import{_ as a,c as i,o as n,aG as l}from"./chunks/framework.DGtm8y85.js";const D=JSON.parse('{"title":"第六章之模式schema","description":"","frontmatter":{"title":"第六章之模式schema","author":"Zack Zheng","date":"2025/07/02 10:40","categories":["PostgreSQL"],"tags":["SQL","唐成"]},"headers":[],"relativePath":"books/techAndCodes/PostgreSQL修炼之道_第2版/第六章之模式schema.md","filePath":"books/techAndCodes/PostgreSQL修炼之道_第2版/第六章之模式schema.md","lastUpdated":1751439707000}'),p={name:"books/techAndCodes/PostgreSQL修炼之道_第2版/第六章之模式schema.md"};function e(h,s,t,k,r,B){return n(),i("div",null,s[0]||(s[0]=[l(`<h4 id="数据库基本操作" tabindex="-1">数据库基本操作 <a class="header-anchor" href="#数据库基本操作" aria-label="Permalink to &quot;数据库基本操作&quot;">​</a></h4><h5 id="创建数据库" tabindex="-1">创建数据库 <a class="header-anchor" href="#创建数据库" aria-label="Permalink to &quot;创建数据库&quot;">​</a></h5><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> database</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> osdbadb</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 创建数据库testdb01，编码LATIN1，模板使用template0</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> database</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> testdb01</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> encoding</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">LATIN1</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> template template0;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># tablespace: 用于指定和新数据库关联的表空间名称</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">connection</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> limit</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">: 用于指定数据库可以接受多少并发连接。默认值为</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">-</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">，表示没有限制</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="修改数据库" tabindex="-1">修改数据库 <a class="header-anchor" href="#修改数据库" aria-label="Permalink to &quot;修改数据库&quot;">​</a></h5><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> database</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> testdb01 </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">connection</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> limit</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 10</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 修改数据库名字</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> database</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> testdb01 rename </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> mydb01;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 关闭数据库testdb01默认索引扫描</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> database</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> testdb01 </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> enable_indexscan </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> off</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="删除数据库" tabindex="-1">删除数据库 <a class="header-anchor" href="#删除数据库" aria-label="Permalink to &quot;删除数据库&quot;">​</a></h5><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 直接删除数据库</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">drop</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> database</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> mytestdb01;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 如果数据库存在，删除之，如果不存在，跳过</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">drop</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> database</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> if</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> exists</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> mytestdb01;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 如果还有用户连接在数据库上，将无法删除数据库</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 不能在事务块中删除数据库</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 可以在事务块中修改数据库</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="模式-schema" tabindex="-1">模式（schema） <a class="header-anchor" href="#模式-schema" aria-label="Permalink to &quot;模式（schema）&quot;">​</a></h4><p><b>概念：</b><br> 可以理解为一个命名空间或目录<br> 不同模式下可以有相同名称的表、函数等对象</p><p><b>关系：</b><br> 一个数据库包含一个或多个模式，模式中包含表、函数以及操作符等数据库对象</p><h5 id="创建模式" tabindex="-1">创建模式 <a class="header-anchor" href="#创建模式" aria-label="Permalink to &quot;创建模式&quot;">​</a></h5><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 创建模式</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> osdba</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 为用户root创建模式，模式名字为test</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> test</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> authorization </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">root</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 在创建模式的同时，创建表的视图</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> osdba</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">    create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> t1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (id </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, title </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">    create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> t2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (id </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, content </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">    create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> view</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> v1</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> as</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">      select</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;"> a</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">id</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">a</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">title</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">b</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">content</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> from</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> t1 a, t2 b </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">where</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;"> a</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">id</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;"> b</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">id</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 修改模式名称</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> osdba rename </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> osdbaold;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 修改属主</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> osdbaold </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">owner</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> web;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>访问模式中的对象，使用<code>模式名.表名</code>语法，不指定模式的时候，默认是<code>public</code>模式</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 在rootshema中创建表student</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> rootshema</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.student (</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  no</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> INTEGER</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> PRIMARY KEY</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  student_name </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">40</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  age </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">INTEGER</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  has_money </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">DECIMAL</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="权限授予" tabindex="-1">权限授予 <a class="header-anchor" href="#权限授予" aria-label="Permalink to &quot;权限授予&quot;">​</a></h5><ul><li><ol><li>授予数据库所有权（最高权限）</li></ol><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> database</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> mydb </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">owner</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> zack;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li><li><ol start="2"><li>授予特定权限（非所有权）</li></ol><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 赋予zack对mydb所有操作权限（如创建表、查询等）</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">grant</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> all privileges </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">on</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> database</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> mydb </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> zack;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><ol start="3"><li>授予schema和表的权限</li></ol><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 授予public schema下当前存在的表的权限</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">grant</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> all privileges </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">on</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> all tables </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">in</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> zackschema </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> zack;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># ⚠️注意要给usage权限</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">grant</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> usage </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">on</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> zackschema </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> zack;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 授予未来新建的表的权限</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> default</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> privileges </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">in</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> zackschema</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">grant</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> all privileges </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">on</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> all tables </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> zack;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 授予特定表的权限</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">grant</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> select</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">insert</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">update</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> on</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> mytable </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> zack;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul><h5 id="删除模式osdba" tabindex="-1">删除模式osdba <a class="header-anchor" href="#删除模式osdba" aria-label="Permalink to &quot;删除模式osdba&quot;">​</a></h5><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 删除模式，可能报错，说有依赖，不能删除</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">drop</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> osdba;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 强制删除</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">drop</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> osdba cascade;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 手动转移表再删除</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># </span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">. 查看依赖对象</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">select</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;"> *</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> from</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> pg_depend</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">where</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> refobjid </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">select</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> oid</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> from</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> pg_namespace </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">where</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> nspname </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">osdba</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># </span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">. 转移对象所有权(把表转移到public)</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;"> osdba</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">table_name</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> set</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> schema</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> public;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># </span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">3</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">. 再删除模式</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div>`,18)]))}const C=a(p,[["render",e]]);export{D as __pageData,C as default};
