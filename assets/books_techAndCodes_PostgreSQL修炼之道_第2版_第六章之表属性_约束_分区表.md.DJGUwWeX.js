import{_ as i,c as a,o as n,aG as l}from"./chunks/framework.DGtm8y85.js";const D=JSON.parse('{"title":"第六章之表属性_约束_分区表","description":"","frontmatter":{"title":"第六章之表属性_约束_分区表","author":"Zack Zheng","date":"2025/07/02 10:40","categories":["PostgreSQL"],"tags":["SQL","唐成","PostgreSQL"]},"headers":[],"relativePath":"books/techAndCodes/PostgreSQL修炼之道_第2版/第六章之表属性_约束_分区表.md","filePath":"books/techAndCodes/PostgreSQL修炼之道_第2版/第六章之表属性_约束_分区表.md","lastUpdated":1755154786000}'),p={name:"books/techAndCodes/PostgreSQL修炼之道_第2版/第六章之表属性_约束_分区表.md"};function h(k,s,e,t,r,B){return n(),a("div",null,s[0]||(s[0]=[l(`<h4 id="创建表" tabindex="-1">创建表 <a class="header-anchor" href="#创建表" aria-label="Permalink to &quot;创建表&quot;">​</a></h4><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 单主键</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> test01</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  note </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">------------------------------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 复合主键(pk_test02是复合主键的名字)</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> test02</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id1 </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id2 </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  note </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">  constraint</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> pk_test02 </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(id1, id2)</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">------------------------------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 约束唯一键</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> test03</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id1 </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id2 </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id3 </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  note </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">  constraint</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> pk_test03 </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(id1, id2),</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">  constraint</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> uk_test03_id3 </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">unique</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(id3) </span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">------------------------------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># check约束</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 约束age年龄不能大于18岁</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> child</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  age </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  note </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">  constraint</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> ck_child_age </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(age</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">18</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">------------------------------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 以其他表为模板创建新表(不会复制列约束, 需要加including关键字)</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> baby</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">like</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> child);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">------------------------------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 表字段默认值</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> student</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  no</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  age </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> default</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 15</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> blog</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  title </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  created_date </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">timestamp</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> default</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> now</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">()</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">update</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> student </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> age</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">default</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> where</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> no</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">------------------------------------------------</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><h4 id="toast技术" tabindex="-1">TOAST技术 <a class="header-anchor" href="#toast技术" aria-label="Permalink to &quot;TOAST技术&quot;">​</a></h4><p>就是特别大的字段的值，会被切割压缩存到另一张TOAST表中，可以使用<br><code>alter table set storage</code>设置或者修改这个规则</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> blog </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> content </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">set</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> storage  </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">external</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="临时表" tabindex="-1">临时表 <a class="header-anchor" href="#临时表" aria-label="Permalink to &quot;临时表&quot;">​</a></h4><p>会话级临时表：数据保存在整个会话的生命周期中<br> 事务级临时表：数据只存在这个事务的生命周期中</p><p>(会话session：也就是客户端与PostgreSQL 服务器的一次连接实例，从登录开始到断开连接结束‌)</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-fOX5E" id="tab-h3KEjRN" checked><label data-title="创建会话级临时表" for="tab-h3KEjRN">创建会话级临时表</label><input type="radio" name="group-fOX5E" id="tab-slnMnHI"><label data-title="创建事务级临时表" for="tab-slnMnHI">创建事务级临时表</label></div><div class="blocks"><div class="language-sql vp-adaptive-theme active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> temporary </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> tmp_t1 (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  note </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">text</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> temporary </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> tmp_t2 (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  note </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">text</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">on</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> commit</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> delete</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> rows</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">/**</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">  on commit子句的3种形式：</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">    1、on commit preserve rows: 不带&quot;on commit&quot;,默认数据存在整个会话周期</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">    2、on commit delete rows: 数据只存在事务周期中，事务提交后数据就消失了</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">    3、on commit drop: 数据存在事务周期中，事务提及后临时表消失</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"> */</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div></div><h4 id="unlogged表-半临时表" tabindex="-1">unlogged表 (半临时表) <a class="header-anchor" href="#unlogged表-半临时表" aria-label="Permalink to &quot;unlogged表 (半临时表)&quot;">​</a></h4><p>没有wal日志，写性能高了，但是数据库异常宕机，数据会丢失</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> unlogged </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> unlogged01 (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  id </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  t </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">text</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="约束" tabindex="-1">约束 <a class="header-anchor" href="#约束" aria-label="Permalink to &quot;约束&quot;">​</a></h4><p>分类：</p><ul><li>检查约束</li><li>非空约束</li><li>唯一约束</li><li>主键</li><li>外键约束</li></ul><p><b>检查约束</b></p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> persons</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">40</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  age </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (age </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;=</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> and</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> age </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&lt;=</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 150</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">), </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 限制年龄在0～150之间</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  sex </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">boolean</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 约束命名为check_age</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> persons</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">40</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  age </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> constraint</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> check_age </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (age </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;=</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> and</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> age </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&lt;=</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 150</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  sex </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">boolean</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 多个字段check</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> books</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  book_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  price </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">numeric</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (price </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),  # 原价 </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">-</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> 字段约束</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  discounted_price </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">numeric</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (discounted_price </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">), # 打折价格 </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">-</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> 字段约束</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">  check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (price </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> discounted_price) # 原价 </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> 打折价格 </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">-</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> 表约束</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><b>非空约束</b></p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> books</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  book_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">integer</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 声明一个字段不能是null</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  price </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">numeric</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 结合检查约束</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> books</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  book_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">integer</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  price </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">numeric</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> not null</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (price </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><b>唯一约束</b></p><p>1个或1组字段相较于其他行是唯一的</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> books</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  book_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">integer</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> unique</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,  # 字段约束唯一</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  price </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">numeric</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> books</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  book_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">integer</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  price </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">numeric</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  unique</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(book_no) # 表约束唯一</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><b>主键</b></p><p>主键和唯一约束的区别是：主键不能为null</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> books</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  book_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">integer</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  price </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">numeric</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  unique</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(book_no)</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><b>外键约束(参照完整性约束)</b></p><p>约束本表中一个或多个字段的数值必须出现在另一个表的一个或多个字段中</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> class</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  class_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  class_name </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">40</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> student</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  student_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> primary key</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  student_name </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">40</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  age </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  class_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> references</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> class(class_no)</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="修改表" tabindex="-1">修改表 <a class="header-anchor" href="#修改表" aria-label="Permalink to &quot;修改表&quot;">​</a></h4><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 增加字段</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> class </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">add</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> column class_teacher </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">40</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 增加字段并且增加约束</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> class </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">add</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> column class_teacher </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">40</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (class_teacher </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&lt;&gt;</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 删除字段</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> class </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">drop</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> column class_teacher;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 如果删除的字段是另一个表的外键，需要增加cascade，同时把另一个表的外键都删掉</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> class </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">drop</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> column class_no cascade;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 增加约束</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> student </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">add</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (age </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 16</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> class </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">add</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> constraint</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> unique_class_teacher </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">unique</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (class_teacher);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> student </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> column student_name </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">set</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 删除约束</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> student </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">drop</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> constraint</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> constraint_name;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 删除非空约束</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> student </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> column student_name </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">drop</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 修改字段默认值</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> student </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> column age </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">set</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> default</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;"> 15</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 删除字段默认值</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> student </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> column age </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">drop</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> default</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 修改字段数据类型</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> student </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> column student_name </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">type</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 重命名字段</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">alter</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> class rename ro classes;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h4 id="表继承" tabindex="-1">表继承 <a class="header-anchor" href="#表继承" aria-label="Permalink to &quot;表继承&quot;">​</a></h4><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> persons</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  name</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> text</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  age </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  sex </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">boolean</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> students</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  class_no </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) inherits (persons);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>⚠️向students插入数据，在persons中也能看到，但是在persons中插入数据，students中看不到<br> ⚠️所有父表中的检查约束和非空约束都会被子表继承，其他类型约束(唯一、主键、外键)<b class="color-red">不会</b>被继承<br> ⚠️子表可以继承多个父表<br> ⚠️使用select、update、delete访问操作父表的时候，也会同时访问和操作子表，使用alter table修改父表结构的定义时，也会同时修改子表的结构定义，但&#39;reindex&#39;和&#39;vacuum&#39;命令不会影响子表<br> 如果只想查询父表(persons)表中的数据:<code>select * from only persons;</code></p><h4 id="分区表" tabindex="-1">分区表 <a class="header-anchor" href="#分区表" aria-label="Permalink to &quot;分区表&quot;">​</a></h4><p>表很大的时候，需要把表拆分成几个小部分，查询更快，就是分区表</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes one-dark-pro material-theme-palenight vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 主表</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sales_detail</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  product_id  </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 产品编号</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  price </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">numeric</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">12</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),      </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 单价</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  amount </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,       </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 数量 </span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  sale_date </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">date</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,   </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 销售日期</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  buyer </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">40</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),         </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 买家名称</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  buyer_content </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">text</span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">         -- 买家的联系方式</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 按销售日期分区，每个月一个分区 （继承的方式实现分区表）</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sale_detail_y2014m01</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (sale_date </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-01-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> and</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> sale_date </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-02-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)) inherits (sales_detail); </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sale_detail_y2014m02</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (sale_date </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-02-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> and</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> sale_date </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-03-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)) inherits (sales_detail); </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sale_detail_y2014m03</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (sale_date </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-03-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> and</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> sale_date </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-04-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)) inherits (sales_detail); </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">/* ...... */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sale_detail_y2014m12</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">check</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (sale_date </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&gt;=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-12-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> and</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> sale_date </span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;">&lt;</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2015-01-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">)) inherits (sales_detail); </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">/*</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">  父表不存放数据，删除旧数据，只需要删除月份最早的表</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"> */</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> # 自动把数据插入正确的的分区，创建触发器</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create or replace</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> function</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sale_detail_insert_trigger</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">()</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">returns</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> trigger </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">as</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> $$</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">begin</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">new</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">sale_date</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> &gt;=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-01-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> and</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;"> new</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">sale_date</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> &lt;</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-02-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">then</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">    insert into</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> sales_detail_y2014m01 </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">values</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (new.</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">*</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  elseif (</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">new</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">sale_date</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> &gt;=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-02-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> and</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;"> new</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">sale_date</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> &lt;</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-03-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">then</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">    insert into</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> sales_detail_y2014m02 </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">values</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (new.</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">*</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">    /* ......省略代码 */</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  elseif (</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">new</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">sale_date</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> &gt;=</span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;"> date</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-12-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> and</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;"> new</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#D19A66;--shiki-dark:#BABED8;">sale_date</span><span style="--shiki-light:#56B6C2;--shiki-dark:#89DDFF;"> &lt;</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2015-01-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">then</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">    insert into</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> sales_detail_y2014m12 </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">values</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (new.</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">*</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  else</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">    raise exception </span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">Date out of range. Fix the sale_detail_insert_trigger () function!</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  end</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> if</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">return</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">end</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">$$</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">language</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> plpgsql;</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> trigger</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> insert_sale_detail_trigger</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  before</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> insert</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> on</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> sale_detail</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  for</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> each </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">row</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> execute</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> procedure</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> sale_detail_insert_trigger </span><span style="--shiki-light:#ABB2BF;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 声明式分区</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sales_detail</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  product_id  </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 产品编号</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  price </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">numeric</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">12</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),      </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 单价</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  amount </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">int</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,       </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 数量 </span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  sale_date </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">date</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> not null</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">,   </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 销售日期</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  buyer </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">varchar</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D19A66;--shiki-dark:#F78C6C;">40</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">),         </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 买家名称</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">  buyer_content </span><span style="--shiki-light:#C678DD;--shiki-dark:#C792EA;">text</span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">         -- 买家的联系方式</span></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">partition</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> by</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> range</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (sale_date);   </span><span style="--shiki-light:#7F848E;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;">-- 声明式分区</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"># 创建分区表的分区</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sales_detail_y2014m01</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> partition</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> of sales_detail</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  for</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> values</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> from</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-01-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-02-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sales_detail_y2014m02</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> partition</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> of sales_detail</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  for</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> values</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> from</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-02-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-03-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">create</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> table</span><span style="--shiki-light:#61AFEF;--shiki-dark:#82AAFF;"> sales_detail_y2014m03</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> partition</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> of sales_detail</span></span>
<span class="line"><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">  for</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> values</span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;"> from</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-03-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#C678DD;--shiki-dark:#F78C6C;">to</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#98C379;--shiki-dark:#C3E88D;">2014-04-01</span><span style="--shiki-light:#98C379;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#ABB2BF;--shiki-dark:#BABED8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div>`,36)]))}const C=i(p,[["render",h]]);export{D as __pageData,C as default};
